---
title: 'Tutoriales sobre Azure Spatial Anchors: 3. Guardar, recuperar y compartir Azure Spatial Anchors'
description: Siga este curso para aprender a implementar Azure Spatial Anchors dentro de una aplicación de realidad mixta.
author: jessemcculloch
ms.author: jemccull
ms.date: 07/01/2020
ms.topic: article
keywords: mixed reality, unity, tutorial, hololens
ms.localizationpriority: high
ms.openlocfilehash: edbbfa6bb4027e6d0d0d37a46575eafdb1d6e631
ms.sourcegitcommit: 09599b4034be825e4536eeb9566968afd021d5f3
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 10/03/2020
ms.locfileid: "91700327"
---
# <a name="3-saving-retrieving-and-sharing-azure-spatial-anchors"></a><span data-ttu-id="e0bf1-105">3. Guardar, recuperar y compartir Azure Spatial Anchors</span><span class="sxs-lookup"><span data-stu-id="e0bf1-105">3. Saving, retrieving, and sharing Azure Spatial Anchors</span></span>

<span data-ttu-id="e0bf1-106">En este tutorial, aprenderás cómo guardar Azure Spatial Anchors en varias sesiones de la aplicación guardando el identificador de anclaje en el almacenamiento de HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-106">In this tutorial, you will learn how to save Azure Spatial Anchors across multiple app sessions by saving the anchor ID to the HoloLens 2's storage.</span></span> <span data-ttu-id="e0bf1-107">También aprenderás a compartir este identificador de anclaje con otros dispositivos para una alineación de anclaje de varios dispositivos.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-107">You will also learn how to share this anchor ID to other devices for a multi-device anchor alignment.</span></span>

## <a name="objectives"></a><span data-ttu-id="e0bf1-108">Objetivos</span><span class="sxs-lookup"><span data-stu-id="e0bf1-108">Objectives</span></span>

* <span data-ttu-id="e0bf1-109">Aprender a lograr la alineación espacial entre varias sesiones de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-109">Learn how to achieve spatial alignment across multiple app sessions.</span></span>
* <span data-ttu-id="e0bf1-110">Aprender a lograr la alineación espacial entre varios dispositivos.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-110">Learn how to achieve spatial alignment between multiple devices.</span></span>

## <a name="preparing-the-scene"></a><span data-ttu-id="e0bf1-111">Preparación de la escena</span><span class="sxs-lookup"><span data-stu-id="e0bf1-111">Preparing the scene</span></span>

<span data-ttu-id="e0bf1-112">En la ventana Hierarchy (Jerarquía), expanda el objeto **ButtonParent** .</span><span class="sxs-lookup"><span data-stu-id="e0bf1-112">In the Hierarchy window, expand the **ButtonParent** object.</span></span> <span data-ttu-id="e0bf1-113">Seleccione los **cuatro últimos objetos de botones secundarios** .</span><span class="sxs-lookup"><span data-stu-id="e0bf1-113">Select the **last four child button** objects.</span></span> <span data-ttu-id="e0bf1-114">En la ventana Inspector, **active** la casilla situada junto al campo de nombre para activar todos los objetos activos.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-114">In the Inspector window, **check** the checkbox next to the name field to make all the objects active.</span></span>

![mr-learning-asa](images/mr-learning-asa/asa-03-section1-step1-1.png)

<span data-ttu-id="e0bf1-116">En la ventana Hierarchy (Jerarquía), expanda los objetos **ButtonParent** .</span><span class="sxs-lookup"><span data-stu-id="e0bf1-116">In the Hierarchy window, select the **ButtonParent** objects.</span></span> <span data-ttu-id="e0bf1-117">A continuación, en la ventana Inspector, busque el componente **GridObjectCollection** y haga clic en el botón **Update Collection** (Actualizar colección) para actualizar la posición de todos los objetos secundarios del objeto **ButtonParent** .</span><span class="sxs-lookup"><span data-stu-id="e0bf1-117">Then in the Inspector window, locate the **GridObjectCollection** component and click the **Update Collection** button to update the position of all the **ButtonParent** object's child objects.</span></span>

![mr-learning-asa](images/mr-learning-asa/asa-03-section1-step1-2.png)

## <a name="persisting-azure-spatial-anchors-between-app-sessions"></a><span data-ttu-id="e0bf1-119">Persistencia de Azure Spatial Anchors entre sesiones de la aplicación</span><span class="sxs-lookup"><span data-stu-id="e0bf1-119">Persisting Azure Spatial Anchors between app sessions</span></span>

<span data-ttu-id="e0bf1-120">En esta sección, aprenderá a guardar y recuperar el identificador de anclaje de Azure desde y hasta el disco local de HoloLens.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-120">In this section, you will learn how to save and retrieve the Azure Anchor ID to and from the HoloLens' local disk.</span></span> <span data-ttu-id="e0bf1-121">De este modo, podrá consultar Azure para el mismo identificador de anclaje entre distintas sesiones de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-121">This will allow you to query Azure for the same anchor ID between different app sessions.</span></span> <span data-ttu-id="e0bf1-122">Se habilitarán los hologramas anclados para que se puedan colocar en la misma ubicación que en la sesión de aplicación anterior.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-122">It will enable the anchored holograms to be positioned at the same location as in the previous app session.</span></span>

<span data-ttu-id="e0bf1-123">En la ventana Hierarchy (Jerarquía), expanda el objeto **ButtonParent** y busque los dos botones denominados **SaveAzureAnchorIdToDisk** y **GetAzureAnchorIdFromDisk** :</span><span class="sxs-lookup"><span data-stu-id="e0bf1-123">In the Hierarchy window, expand the **ButtonParent** object and locate the two buttons named **SaveAzureAnchorIdToDisk** and **GetAzureAnchorIdFromDisk** :</span></span>

![mr-learning-asa](images/mr-learning-asa/asa-03-section2-step1-1.png)

<span data-ttu-id="e0bf1-125">Siga los mismos pasos de las instrucciones proporcionadas en [Configuración de los botones para el funcionamiento de la escena](mr-learning-asa-02.md#configuring-the-buttons-to-operate-the-scene) del tutorial anterior para configurar el componente **Interactable (Script)** (Interactuable [script]) en cada uno de los dos botones:</span><span class="sxs-lookup"><span data-stu-id="e0bf1-125">Follow the same steps as in the [configuring the buttons to operate the scene](mr-learning-asa-02.md#configuring-the-buttons-to-operate-the-scene) instructions from the previous tutorial to configure the **Interactable (Script)** component on each of the two buttons:</span></span>

* <span data-ttu-id="e0bf1-126">Para el objeto del botón **SaveAzureAnchorIdToDisk** , asigne la función AnchorModuleScript > **SaveAzureAnchorIdToDisk ()** .</span><span class="sxs-lookup"><span data-stu-id="e0bf1-126">For the **SaveAzureAnchorIdToDisk** button object, assign the AnchorModuleScript > **SaveAzureAnchorIdToDisk ()** function.</span></span>
* <span data-ttu-id="e0bf1-127">Para el objeto del botón **GetAzureAnchorIdFromDisk** , asigne la función AnchorModuleScript > **GetAzureAnchorIdFromDisk ()** .</span><span class="sxs-lookup"><span data-stu-id="e0bf1-127">For the **GetAzureAnchorIdFromDisk** button object, assign the AnchorModuleScript > **GetAzureAnchorIdFromDisk ()** function.</span></span>

<span data-ttu-id="e0bf1-128">Si compila la aplicación actualizada en HoloLens, puede conservar Azure Spatial Anchors entre sesiones de aplicación si guarda el identificador del anclaje de Azure.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-128">If you build the updated app to your HoloLens, you can now persist Azure Spatial Anchors between app sessions by saving the Azure Anchor ID.</span></span> <span data-ttu-id="e0bf1-129">Para probarlo, puedes seguir estos pasos:</span><span class="sxs-lookup"><span data-stu-id="e0bf1-129">To test it out, you can follow these steps:</span></span>

1. <span data-ttu-id="e0bf1-130">Mueva el explorador del róver a la ubicación deseada.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-130">Move the Rover Explorer to the desired location</span></span>
2. <span data-ttu-id="e0bf1-131">Inicie una sesión de Azure.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-131">Start Azure Session</span></span>
3. <span data-ttu-id="e0bf1-132">Crea un anclaje de Azure (se crean anclajes en la ubicación del explorador de róver).</span><span class="sxs-lookup"><span data-stu-id="e0bf1-132">Create Azure Anchor (creates anchors at the location of the Rover Explorer)</span></span>
4. <span data-ttu-id="e0bf1-133">Guarde el identificador del anclaje de Azure en el disco.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-133">Save Azure Anchor ID to Disk</span></span>
5. <span data-ttu-id="e0bf1-134">Reinicie el equipo.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-134">Restart the app</span></span>
6. <span data-ttu-id="e0bf1-135">Obtenga el anclaje de Azure del disco (se carga el identificador de anclaje que acaba de guardar).</span><span class="sxs-lookup"><span data-stu-id="e0bf1-135">Get Azure Anchor from Disk (loads the anchor ID you just saved)</span></span>
7. <span data-ttu-id="e0bf1-136">Inicia una sesión de Azure.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-136">Start Azure Session</span></span>
8. <span data-ttu-id="e0bf1-137">Busque el anclaje de Azure (coloca el explorador del róver en la ubicación del paso 3).</span><span class="sxs-lookup"><span data-stu-id="e0bf1-137">Find Azure Anchor (positions the Rover Explorer at the location from step 3)</span></span>

> [!NOTE]
> <span data-ttu-id="e0bf1-138">Para reiniciar completamente la aplicación, después de salir de la vista de aplicación inmersiva, la ventana de la aplicación en el ambiente principal debe cerrarse antes de volver a iniciar la aplicación desde el menú Inicio.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-138">To fully restart the app, after exiting the immersive app view, the app window in the mixed reality home needs to be closed before relaunching it from the Start menu.</span></span> <span data-ttu-id="e0bf1-139">Para obtener más información, puedes consultar la documentación de [Usar aplicaciones en HoloLens](https://docs.microsoft.com/hololens/holographic-home#using-apps-on-hololens).</span><span class="sxs-lookup"><span data-stu-id="e0bf1-139">For additional details, you can refer to the [Using apps on HoloLens](https://docs.microsoft.com/hololens/holographic-home#using-apps-on-hololens) documentation.</span></span>

## <a name="sharing-azure-spatial-anchors-between-devices"></a><span data-ttu-id="e0bf1-140">Uso compartido de Azure Spatial Anchors entre sesiones de la aplicación</span><span class="sxs-lookup"><span data-stu-id="e0bf1-140">Sharing Azure Spatial Anchors between devices</span></span>

<span data-ttu-id="e0bf1-141">En esta sección, obtendrás información sobre cómo compartir el identificador del anclaje de Azure entre varios dispositivos.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-141">In this section, you will learn how to share the Azure Anchor ID between multiple devices.</span></span> <span data-ttu-id="e0bf1-142">Esto permitirá que varios dispositivos consulten Azure para el mismo identificador de anclaje, lo que permite alinear espacialmente los hologramas delimitados.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-142">This will allow multiple devices to query Azure for the same anchor ID, allowing the anchored holograms to be spatially aligned.</span></span> <span data-ttu-id="e0bf1-143">La alineación espacial, que permite ver los mismos hologramas en la misma ubicación física entre varios dispositivos, es fundamental para las experiencias compartidas locales en HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-143">Spatial alignment, i.e., seeing the same holograms in the same physical location between multiple devices, is key to local shared experiences in the HoloLens 2.</span></span>

<span data-ttu-id="e0bf1-144">Hay muchas formas de transferir identificadores de anclaje de Azure entre dispositivos, incluidos los métodos descritos en la serie [Tutoriales de funcionalidades de varios usuarios](mr-learning-sharing-02.md).</span><span class="sxs-lookup"><span data-stu-id="e0bf1-144">There are many ways to transfer Azure Anchor IDs between devices, including methods outlined in the [Multi-user capabilities tutorials](mr-learning-sharing-02.md) series.</span></span> <span data-ttu-id="e0bf1-145">En este ejemplo, usarás un servicio web simple para cargar y descargar los id. de anclaje entre dispositivos.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-145">In this example, you will use a simple web service to upload and download anchor IDs between devices.</span></span>

<span data-ttu-id="e0bf1-146">En la ventana Hierarchy (Jerarquía), expanda el objeto **ButtonParent** .</span><span class="sxs-lookup"><span data-stu-id="e0bf1-146">In the Hierarchy window, expand the **ButtonParent** object.</span></span>   <span data-ttu-id="e0bf1-147">Busque los dos botones denominados **ShareAzureAnchorIdToNetwork** y **GetAzureAnchorIdFromNetwork** :</span><span class="sxs-lookup"><span data-stu-id="e0bf1-147">Locate the two buttons named **ShareAzureAnchorIdToNetwork** and **GetAzureAnchorIdFromNetwork** :</span></span>

![mr-learning-asa](images/mr-learning-asa/asa-03-section3-step1-1.png)

<span data-ttu-id="e0bf1-149">Siga los mismos pasos de las instrucciones proporcionadas en [Configuración de los botones para el funcionamiento de la escena](mr-learning-asa-02.md#configuring-the-buttons-to-operate-the-scene) del tutorial anterior para configurar el componente **Interactable (Script)** (Interactuable [script]) en cada uno de los dos botones:</span><span class="sxs-lookup"><span data-stu-id="e0bf1-149">Follow the same steps as in the [configuring the buttons to operate the scene](mr-learning-asa-02.md#configuring-the-buttons-to-operate-the-scene) instructions from the previous tutorial to configure the **Interactable (Script)** component on each of the two buttons:</span></span>

* <span data-ttu-id="e0bf1-150">Para el objeto **ShareAzureAnchorIdToNetwork** , asigna la función AnchorModuleScript > **ShareAzureAnchorIdToNetwork ()** .</span><span class="sxs-lookup"><span data-stu-id="e0bf1-150">For the **ShareAzureAnchorIdToNetwork** object, assign the AnchorModuleScript > **ShareAzureAnchorIdToNetwork ()** function.</span></span>
* <span data-ttu-id="e0bf1-151">Para el objeto **GetAzureAnchorIdFromNetwork** , asigna la función AnchorModuleScript > **GetAzureAnchorIdFromNetwork ()** .</span><span class="sxs-lookup"><span data-stu-id="e0bf1-151">For the **GetAzureAnchorIdFromNetwork** object, assign the AnchorModuleScript > **GetAzureAnchorIdFromNetwork ()** function.</span></span>

<span data-ttu-id="e0bf1-152">Si compilas la aplicación actualizada en dos dispositivos HoloLens, ahora puede lograr la alineación espacial al compartir el identificador de anclaje de Azure.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-152">If you build the updated app to two HoloLens devices, you can now achieve spatial alignment by sharing the Azure Anchor ID.</span></span> <span data-ttu-id="e0bf1-153">Para probarlo, puedes seguir estos pasos:</span><span class="sxs-lookup"><span data-stu-id="e0bf1-153">To test it out, you can follow these steps:</span></span>

1. <span data-ttu-id="e0bf1-154">En el dispositivo HoloLens 1: Mueva el explorador del róver a la ubicación deseada.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-154">On HoloLens device 1: Move the Rover Explorer to the desired location.</span></span>
2. <span data-ttu-id="e0bf1-155">En el dispositivo HoloLens 1: inicia una sesión de Azure.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-155">On HoloLens device 1: Start Azure Session.</span></span>
3. <span data-ttu-id="e0bf1-156">En el dispositivo HoloLens 1: Cree un anclaje de Azure (se crean anclajes en la ubicación del explorador de róver).</span><span class="sxs-lookup"><span data-stu-id="e0bf1-156">On HoloLens device 1: Create Azure Anchor (creates anchors at the location of the Rover Explorer).</span></span>
4. <span data-ttu-id="e0bf1-157">En el dispositivo HoloLens 1: comparte el id. de anclaje de Azure con la red</span><span class="sxs-lookup"><span data-stu-id="e0bf1-157">On HoloLens device 1: Share Azure Anchor ID to Network.</span></span>
5. <span data-ttu-id="e0bf1-158">En el dispositivo HoloLens 2: Inicie la aplicación.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-158">On HoloLens device 2: Start the app.</span></span>
6. <span data-ttu-id="e0bf1-159">En el dispositivo HoloLens 2: obtén el identificador de anclaje compartido de la red (captura el identificador de anclaje que se acaba de compartir desde el dispositivo HoloLens 1).</span><span class="sxs-lookup"><span data-stu-id="e0bf1-159">On HoloLens device 2: Get Shared Anchor ID from Network (fetches the anchor ID just shared from HoloLens device 1).</span></span>
7. <span data-ttu-id="e0bf1-160">En el dispositivo HoloLens 2: inicia una sesión de Azure.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-160">On HoloLens device 2: Start Azure Session.</span></span>
8. <span data-ttu-id="e0bf1-161">En el dispositivo HoloLens 2: Busque el anclaje de Azure (se coloca el explorador del róver en la ubicación del paso 3).</span><span class="sxs-lookup"><span data-stu-id="e0bf1-161">On HoloLens device 2: Find Azure Anchor (positions the Rover Explorer at the location from step 3).</span></span>

> [!TIP]
> <span data-ttu-id="e0bf1-162">Si solo tiene un dispositivo HoloLens, puede probar la funcionalidad igualmente reiniciando la aplicación, en lugar de usar un segundo dispositivo HoloLens.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-162">If you only have one HoloLens, you can still test the functionality by restarting the app instead of using a second HoloLens device.</span></span>

## <a name="congratulations"></a><span data-ttu-id="e0bf1-163">Enhorabuena</span><span class="sxs-lookup"><span data-stu-id="e0bf1-163">Congratulations</span></span>

<span data-ttu-id="e0bf1-164">En este tutorial ha aprendido a conservar Azure Spatial Anchors entre las sesiones y reinicios de aplicación al guardar el identificador de anclaje espacial de Azure en el disco local de HoloLens.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-164">In this tutorial, you learned how to persist Azure Spatial Anchors between app sessions and app restarts by saving the Azure Spatial Anchor ID to the local disk on HoloLens.</span></span> <span data-ttu-id="e0bf1-165">También has aprendido a compartir Azure Spatial Anchors entre varios dispositivos para una experiencia de uso compartido con hologramas estáticos y varios usuarios.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-165">You also learned how to share Azure Spatial Anchors between multiple devices for a basic multi-user, static hologram shared experience.</span></span>

<span data-ttu-id="e0bf1-166">En el siguiente tutorial, aprenderá a proporcionar a los usuarios comentarios en tiempo real.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-166">In the next tutorial, you will learn how to provide users with real-time feedback.</span></span> <span data-ttu-id="e0bf1-167">Estos comentarios incluirán información sobre la creación de los anclajes, la calidad de la comprensión del entorno y el estado de la sesión de Azure.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-167">This feedback will include information about Anchor creation, the quality of environment understanding, and the Azure session's state.</span></span> <span data-ttu-id="e0bf1-168">Sin comentarios, es posible que los usuarios no sepan si un anclaje se ha cargado correctamente en Azure, si la calidad del entorno es suficiente para la creación del anclaje o el estado actual.</span><span class="sxs-lookup"><span data-stu-id="e0bf1-168">Without feedback, users may not know whether an anchor has successfully been uploaded to Azure, whether the quality of the environment is sufficient for anchor creation, or the current state.</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="e0bf1-169">Tutorial siguiente: 4. Visualización de comentarios de Azure Spatial Anchors</span><span class="sxs-lookup"><span data-stu-id="e0bf1-169">Next Tutorial: 4. Displaying Azure Spatial Anchor feedback</span></span>](mr-learning-asa-04.md)
