---
title: Guardar, recuperar y compartir Azure Spatial Anchors
description: Siga este curso para aprender a guardar, recuperar y compartir Azure Spatial Anchors en una aplicación de realidad mixta.
author: jessemcculloch
ms.author: jemccull
ms.date: 07/01/2020
ms.topic: article
keywords: mixed reality, unity, tutorial, hololens, MRTK, mixed reality toolkit, UWP, Azure spatial anchors, app sessions
ms.localizationpriority: high
ms.openlocfilehash: 4bae36bfb24130fc7914563af07c09374162f3cb
ms.sourcegitcommit: d3a3b4f13b3728cfdd4d43035c806c0791d3f2fe
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 01/20/2021
ms.locfileid: "98582050"
---
# <a name="3-saving-retrieving-and-sharing-azure-spatial-anchors"></a><span data-ttu-id="76ea0-104">3. Guardar, recuperar y compartir Azure Spatial Anchors</span><span class="sxs-lookup"><span data-stu-id="76ea0-104">3. Saving, retrieving, and sharing Azure Spatial Anchors</span></span>

<span data-ttu-id="76ea0-105">En este tutorial, aprenderás cómo guardar Azure Spatial Anchors en varias sesiones de la aplicación guardando el identificador de anclaje en el almacenamiento de HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="76ea0-105">In this tutorial, you will learn how to save Azure Spatial Anchors across multiple app sessions by saving the anchor ID to the HoloLens 2's storage.</span></span> <span data-ttu-id="76ea0-106">También aprenderás a compartir este identificador de anclaje con otros dispositivos para una alineación de anclaje de varios dispositivos.</span><span class="sxs-lookup"><span data-stu-id="76ea0-106">You will also learn how to share this anchor ID to other devices for a multi-device anchor alignment.</span></span>

## <a name="objectives"></a><span data-ttu-id="76ea0-107">Objetivos</span><span class="sxs-lookup"><span data-stu-id="76ea0-107">Objectives</span></span>

* <span data-ttu-id="76ea0-108">Aprender a lograr la alineación espacial entre varias sesiones de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="76ea0-108">Learn how to achieve spatial alignment across multiple app sessions.</span></span>
* <span data-ttu-id="76ea0-109">Aprender a lograr la alineación espacial entre varios dispositivos.</span><span class="sxs-lookup"><span data-stu-id="76ea0-109">Learn how to achieve spatial alignment between multiple devices.</span></span>

## <a name="preparing-the-scene"></a><span data-ttu-id="76ea0-110">Preparación de la escena</span><span class="sxs-lookup"><span data-stu-id="76ea0-110">Preparing the scene</span></span>

<span data-ttu-id="76ea0-111">En la ventana Hierarchy (Jerarquía), expanda el objeto **ButtonParent**.</span><span class="sxs-lookup"><span data-stu-id="76ea0-111">In the Hierarchy window, expand the **ButtonParent** object.</span></span> <span data-ttu-id="76ea0-112">Seleccione los **cuatro últimos objetos de botones secundarios**.</span><span class="sxs-lookup"><span data-stu-id="76ea0-112">Select the **last four child button** objects.</span></span> <span data-ttu-id="76ea0-113">En la ventana Inspector, **active** la casilla situada junto al campo de nombre para activar todos los objetos activos.</span><span class="sxs-lookup"><span data-stu-id="76ea0-113">In the Inspector window, **check** the checkbox next to the name field to make all the objects active.</span></span>

![Unity con objetos de botón anteriormente inactivos seleccionados y activos](images/mr-learning-asa/asa-03-section1-step1-1.png)

<span data-ttu-id="76ea0-115">En la ventana Hierarchy (Jerarquía), expanda los objetos **ButtonParent**.</span><span class="sxs-lookup"><span data-stu-id="76ea0-115">In the Hierarchy window, select the **ButtonParent** objects.</span></span> <span data-ttu-id="76ea0-116">A continuación, en la ventana Inspector, busque el componente **GridObjectCollection** y haga clic en el botón **Update Collection** (Actualizar colección) para actualizar la posición de todos los objetos secundarios del objeto **ButtonParent**.</span><span class="sxs-lookup"><span data-stu-id="76ea0-116">Then in the Inspector window, locate the **GridObjectCollection** component and click the **Update Collection** button to update the position of all the **ButtonParent** object's child objects.</span></span>

![Unity con el componente GridObjectCollection actualizado](images/mr-learning-asa/asa-03-section1-step1-2.png)

## <a name="persisting-azure-spatial-anchors-between-app-sessions"></a><span data-ttu-id="76ea0-118">Persistencia de Azure Spatial Anchors entre sesiones de la aplicación</span><span class="sxs-lookup"><span data-stu-id="76ea0-118">Persisting Azure Spatial Anchors between app sessions</span></span>

<span data-ttu-id="76ea0-119">En esta sección, aprenderá a guardar y recuperar el identificador de anclaje de Azure desde y hasta el disco local de HoloLens.</span><span class="sxs-lookup"><span data-stu-id="76ea0-119">In this section, you will learn how to save and retrieve the Azure Anchor ID to and from the HoloLens' local disk.</span></span> <span data-ttu-id="76ea0-120">De este modo, podrá consultar Azure para el mismo identificador de anclaje entre distintas sesiones de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="76ea0-120">This will allow you to query Azure for the same anchor ID between different app sessions.</span></span> <span data-ttu-id="76ea0-121">Se habilitarán los hologramas anclados para que se puedan colocar en la misma ubicación que en la sesión de aplicación anterior.</span><span class="sxs-lookup"><span data-stu-id="76ea0-121">It will enable the anchored holograms to be positioned at the same location as in the previous app session.</span></span>

<span data-ttu-id="76ea0-122">En la ventana Hierarchy (Jerarquía), expanda el objeto **ButtonParent** y busque los dos botones denominados **SaveAzureAnchorIdToDisk** y **GetAzureAnchorIdFromDisk**:</span><span class="sxs-lookup"><span data-stu-id="76ea0-122">In the Hierarchy window, expand the **ButtonParent** object and locate the two buttons named **SaveAzureAnchorIdToDisk** and **GetAzureAnchorIdFromDisk**:</span></span>

![Unity con los objetos de botón SaveAzureAnchorIdToDisk y GetAzureAnchorIdFromDisk seleccionados](images/mr-learning-asa/asa-03-section2-step1-1.png)

<span data-ttu-id="76ea0-124">Siga los mismos pasos de las instrucciones proporcionadas en [Configuración de los botones para el funcionamiento de la escena](mr-learning-asa-02.md#configuring-the-buttons-to-operate-the-scene) del tutorial anterior para configurar el componente **Interactable (Script)** (Interactuable [script]) en cada uno de los dos botones:</span><span class="sxs-lookup"><span data-stu-id="76ea0-124">Follow the same steps as in the [configuring the buttons to operate the scene](mr-learning-asa-02.md#configuring-the-buttons-to-operate-the-scene) instructions from the previous tutorial to configure the **Interactable (Script)** component on each of the two buttons:</span></span>

* <span data-ttu-id="76ea0-125">Para el objeto del botón **SaveAzureAnchorIdToDisk**, asigne la función AnchorModuleScript > **SaveAzureAnchorIdToDisk ()** .</span><span class="sxs-lookup"><span data-stu-id="76ea0-125">For the **SaveAzureAnchorIdToDisk** button object, assign the AnchorModuleScript > **SaveAzureAnchorIdToDisk ()** function.</span></span>
* <span data-ttu-id="76ea0-126">Para el objeto del botón **GetAzureAnchorIdFromDisk**, asigne la función AnchorModuleScript > **GetAzureAnchorIdFromDisk ()** .</span><span class="sxs-lookup"><span data-stu-id="76ea0-126">For the **GetAzureAnchorIdFromDisk** button object, assign the AnchorModuleScript > **GetAzureAnchorIdFromDisk ()** function.</span></span>

<span data-ttu-id="76ea0-127">Si compila la aplicación actualizada en HoloLens, puede conservar Azure Spatial Anchors entre sesiones de aplicación si guarda el identificador del anclaje de Azure.</span><span class="sxs-lookup"><span data-stu-id="76ea0-127">If you build the updated app to your HoloLens, you can now persist Azure Spatial Anchors between app sessions by saving the Azure Anchor ID.</span></span> <span data-ttu-id="76ea0-128">Para probarlo, puedes seguir estos pasos:</span><span class="sxs-lookup"><span data-stu-id="76ea0-128">To test it out, you can follow these steps:</span></span>

1. <span data-ttu-id="76ea0-129">Mueva el explorador del róver a la ubicación deseada.</span><span class="sxs-lookup"><span data-stu-id="76ea0-129">Move the Rover Explorer to the desired location</span></span>
2. <span data-ttu-id="76ea0-130">Inicie una sesión de Azure.</span><span class="sxs-lookup"><span data-stu-id="76ea0-130">Start Azure Session</span></span>
3. <span data-ttu-id="76ea0-131">Crea un anclaje de Azure (se crean anclajes en la ubicación del explorador de róver).</span><span class="sxs-lookup"><span data-stu-id="76ea0-131">Create Azure Anchor (creates anchors at the location of the Rover Explorer)</span></span>
4. <span data-ttu-id="76ea0-132">Guarde el identificador del anclaje de Azure en el disco.</span><span class="sxs-lookup"><span data-stu-id="76ea0-132">Save Azure Anchor ID to Disk</span></span>
5. <span data-ttu-id="76ea0-133">Reinicie el equipo.</span><span class="sxs-lookup"><span data-stu-id="76ea0-133">Restart the app</span></span>
6. <span data-ttu-id="76ea0-134">Obtenga el anclaje de Azure del disco (se carga el identificador de anclaje que acaba de guardar).</span><span class="sxs-lookup"><span data-stu-id="76ea0-134">Get Azure Anchor from Disk (loads the anchor ID you just saved)</span></span>
7. <span data-ttu-id="76ea0-135">Inicia una sesión de Azure.</span><span class="sxs-lookup"><span data-stu-id="76ea0-135">Start Azure Session</span></span>
8. <span data-ttu-id="76ea0-136">Busque el anclaje de Azure (coloca el explorador del róver en la ubicación del paso 3).</span><span class="sxs-lookup"><span data-stu-id="76ea0-136">Find Azure Anchor (positions the Rover Explorer at the location from step 3)</span></span>

> [!NOTE]
> <span data-ttu-id="76ea0-137">Para reiniciar completamente la aplicación, después de salir de la vista de aplicación inmersiva, la ventana de la aplicación en el ambiente principal debe cerrarse antes de volver a iniciar la aplicación desde el menú Inicio.</span><span class="sxs-lookup"><span data-stu-id="76ea0-137">To fully restart the app, after exiting the immersive app view, the app window in the mixed reality home needs to be closed before relaunching it from the Start menu.</span></span> <span data-ttu-id="76ea0-138">Para obtener más información, puedes consultar la documentación de [Usar aplicaciones en HoloLens](/hololens/holographic-home#using-apps-on-hololens).</span><span class="sxs-lookup"><span data-stu-id="76ea0-138">For additional details, you can refer to the [Using apps on HoloLens](/hololens/holographic-home#using-apps-on-hololens) documentation.</span></span>

## <a name="sharing-azure-spatial-anchors-between-devices"></a><span data-ttu-id="76ea0-139">Uso compartido de Azure Spatial Anchors entre sesiones de la aplicación</span><span class="sxs-lookup"><span data-stu-id="76ea0-139">Sharing Azure Spatial Anchors between devices</span></span>

<span data-ttu-id="76ea0-140">En esta sección, obtendrás información sobre cómo compartir el identificador del anclaje de Azure entre varios dispositivos.</span><span class="sxs-lookup"><span data-stu-id="76ea0-140">In this section, you will learn how to share the Azure Anchor ID between multiple devices.</span></span> <span data-ttu-id="76ea0-141">Esto permitirá que varios dispositivos consulten Azure para el mismo identificador de anclaje, lo que permite alinear espacialmente los hologramas delimitados.</span><span class="sxs-lookup"><span data-stu-id="76ea0-141">This will allow multiple devices to query Azure for the same anchor ID, allowing the anchored holograms to be spatially aligned.</span></span> <span data-ttu-id="76ea0-142">La alineación espacial, que permite ver los mismos hologramas en la misma ubicación física entre varios dispositivos, es fundamental para las experiencias compartidas locales en HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="76ea0-142">Spatial alignment, i.e., seeing the same holograms in the same physical location between multiple devices, is key to local shared experiences in the HoloLens 2.</span></span>

<span data-ttu-id="76ea0-143">Hay muchas formas de transferir identificadores de anclaje de Azure entre dispositivos, incluidos los métodos descritos en la serie [Tutoriales de funcionalidades de varios usuarios](mr-learning-sharing-02.md).</span><span class="sxs-lookup"><span data-stu-id="76ea0-143">There are many ways to transfer Azure Anchor IDs between devices, including methods outlined in the [Multi-user capabilities tutorials](mr-learning-sharing-02.md) series.</span></span> <span data-ttu-id="76ea0-144">En este ejemplo, usarás un servicio web simple para cargar y descargar los id. de anclaje entre dispositivos.</span><span class="sxs-lookup"><span data-stu-id="76ea0-144">In this example, you will use a simple web service to upload and download anchor IDs between devices.</span></span>

<span data-ttu-id="76ea0-145">En la ventana Hierarchy (Jerarquía), expanda el objeto **ButtonParent**.</span><span class="sxs-lookup"><span data-stu-id="76ea0-145">In the Hierarchy window, expand the **ButtonParent** object.</span></span>   <span data-ttu-id="76ea0-146">Busque los dos botones denominados **ShareAzureAnchorIdToNetwork** y **GetAzureAnchorIdFromNetwork**:</span><span class="sxs-lookup"><span data-stu-id="76ea0-146">Locate the two buttons named **ShareAzureAnchorIdToNetwork** and **GetAzureAnchorIdFromNetwork**:</span></span>

![Unity con los objetos de botón ShareAzureAnchorIdToNetwork y GetAzureAnchorIdFromNetwork seleccionados](images/mr-learning-asa/asa-03-section3-step1-1.png)

<span data-ttu-id="76ea0-148">Siga los mismos pasos de las instrucciones proporcionadas en [Configuración de los botones para el funcionamiento de la escena](mr-learning-asa-02.md#configuring-the-buttons-to-operate-the-scene) del tutorial anterior para configurar el componente **Interactable (Script)** (Interactuable [script]) en cada uno de los dos botones:</span><span class="sxs-lookup"><span data-stu-id="76ea0-148">Follow the same steps as in the [configuring the buttons to operate the scene](mr-learning-asa-02.md#configuring-the-buttons-to-operate-the-scene) instructions from the previous tutorial to configure the **Interactable (Script)** component on each of the two buttons:</span></span>

* <span data-ttu-id="76ea0-149">Para el objeto **ShareAzureAnchorIdToNetwork**, asigna la función AnchorModuleScript > **ShareAzureAnchorIdToNetwork ()** .</span><span class="sxs-lookup"><span data-stu-id="76ea0-149">For the **ShareAzureAnchorIdToNetwork** object, assign the AnchorModuleScript > **ShareAzureAnchorIdToNetwork ()** function.</span></span>
* <span data-ttu-id="76ea0-150">Para el objeto **GetAzureAnchorIdFromNetwork**, asigna la función AnchorModuleScript > **GetAzureAnchorIdFromNetwork ()** .</span><span class="sxs-lookup"><span data-stu-id="76ea0-150">For the **GetAzureAnchorIdFromNetwork** object, assign the AnchorModuleScript > **GetAzureAnchorIdFromNetwork ()** function.</span></span>

<span data-ttu-id="76ea0-151">Si compilas la aplicación actualizada en dos dispositivos HoloLens, ahora puede lograr la alineación espacial al compartir el identificador de anclaje de Azure.</span><span class="sxs-lookup"><span data-stu-id="76ea0-151">If you build the updated app to two HoloLens devices, you can now achieve spatial alignment by sharing the Azure Anchor ID.</span></span> <span data-ttu-id="76ea0-152">Para probarlo, puedes seguir estos pasos:</span><span class="sxs-lookup"><span data-stu-id="76ea0-152">To test it out, you can follow these steps:</span></span>

1. <span data-ttu-id="76ea0-153">En el dispositivo HoloLens 1: Mueva el explorador del róver a la ubicación deseada.</span><span class="sxs-lookup"><span data-stu-id="76ea0-153">On HoloLens device 1: Move the Rover Explorer to the desired location.</span></span>
2. <span data-ttu-id="76ea0-154">En el dispositivo HoloLens 1: inicia una sesión de Azure.</span><span class="sxs-lookup"><span data-stu-id="76ea0-154">On HoloLens device 1: Start Azure Session.</span></span>
3. <span data-ttu-id="76ea0-155">En el dispositivo HoloLens 1: Cree un anclaje de Azure (se crean anclajes en la ubicación del explorador de róver).</span><span class="sxs-lookup"><span data-stu-id="76ea0-155">On HoloLens device 1: Create Azure Anchor (creates anchors at the location of the Rover Explorer).</span></span>
4. <span data-ttu-id="76ea0-156">En el dispositivo HoloLens 1: comparte el id. de anclaje de Azure con la red</span><span class="sxs-lookup"><span data-stu-id="76ea0-156">On HoloLens device 1: Share Azure Anchor ID to Network.</span></span>
5. <span data-ttu-id="76ea0-157">En el dispositivo HoloLens 2: Inicie la aplicación.</span><span class="sxs-lookup"><span data-stu-id="76ea0-157">On HoloLens device 2: Start the app.</span></span>
6. <span data-ttu-id="76ea0-158">En el dispositivo HoloLens 2: obtén el identificador de anclaje compartido de la red (captura el identificador de anclaje que se acaba de compartir desde el dispositivo HoloLens 1).</span><span class="sxs-lookup"><span data-stu-id="76ea0-158">On HoloLens device 2: Get Shared Anchor ID from Network (fetches the anchor ID just shared from HoloLens device 1).</span></span>
7. <span data-ttu-id="76ea0-159">En el dispositivo HoloLens 2: inicia una sesión de Azure.</span><span class="sxs-lookup"><span data-stu-id="76ea0-159">On HoloLens device 2: Start Azure Session.</span></span>
8. <span data-ttu-id="76ea0-160">En el dispositivo HoloLens 2: Busque el anclaje de Azure (se coloca el explorador del róver en la ubicación del paso 3).</span><span class="sxs-lookup"><span data-stu-id="76ea0-160">On HoloLens device 2: Find Azure Anchor (positions the Rover Explorer at the location from step 3).</span></span>

> [!TIP]
> <span data-ttu-id="76ea0-161">Si solo tiene un dispositivo HoloLens, puede probar la funcionalidad igualmente reiniciando la aplicación, en lugar de usar un segundo dispositivo HoloLens.</span><span class="sxs-lookup"><span data-stu-id="76ea0-161">If you only have one HoloLens, you can still test the functionality by restarting the app instead of using a second HoloLens device.</span></span>

## <a name="congratulations"></a><span data-ttu-id="76ea0-162">Enhorabuena</span><span class="sxs-lookup"><span data-stu-id="76ea0-162">Congratulations</span></span>

<span data-ttu-id="76ea0-163">En este tutorial ha aprendido a conservar Azure Spatial Anchors entre las sesiones y reinicios de aplicación al guardar el identificador de anclaje espacial de Azure en el disco local de HoloLens.</span><span class="sxs-lookup"><span data-stu-id="76ea0-163">In this tutorial, you learned how to persist Azure Spatial Anchors between app sessions and app restarts by saving the Azure Spatial Anchor ID to the local disk on HoloLens.</span></span> <span data-ttu-id="76ea0-164">También has aprendido a compartir Azure Spatial Anchors entre varios dispositivos para una experiencia de uso compartido con hologramas estáticos y varios usuarios.</span><span class="sxs-lookup"><span data-stu-id="76ea0-164">You also learned how to share Azure Spatial Anchors between multiple devices for a basic multi-user, static hologram shared experience.</span></span>

<span data-ttu-id="76ea0-165">En el siguiente tutorial, aprenderá a proporcionar a los usuarios comentarios en tiempo real.</span><span class="sxs-lookup"><span data-stu-id="76ea0-165">In the next tutorial, you will learn how to provide users with real-time feedback.</span></span> <span data-ttu-id="76ea0-166">Estos comentarios incluirán información sobre la creación de los anclajes, la calidad de la comprensión del entorno y el estado de la sesión de Azure.</span><span class="sxs-lookup"><span data-stu-id="76ea0-166">This feedback will include information about Anchor creation, the quality of environment understanding, and the Azure session's state.</span></span> <span data-ttu-id="76ea0-167">Sin comentarios, es posible que los usuarios no sepan si un anclaje se ha cargado correctamente en Azure, si la calidad del entorno es suficiente para la creación del anclaje o el estado actual.</span><span class="sxs-lookup"><span data-stu-id="76ea0-167">Without feedback, users may not know whether an anchor has successfully been uploaded to Azure, whether the quality of the environment is sufficient for anchor creation, or the current state.</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="76ea0-168">Tutorial siguiente: 4. Visualización de comentarios de Azure Spatial Anchors</span><span class="sxs-lookup"><span data-stu-id="76ea0-168">Next Tutorial: 4. Displaying Azure Spatial Anchor feedback</span></span>](mr-learning-asa-04.md)